// ============================================
// dukarun DESIGN SYSTEM — SINGLE SOURCE OF TRUTH
// ============================================
//
// This file is the only design system source. It contains:
// - Principles (below)
// - Tokens (breakpoints, spacing, type, touch, radius, shadows, transitions, z-index, containers)
// - Mixins (tablet, desktop, touch-target, card, focus-ring, truncate, line-clamp, etc.)
// - Pattern classes (.card-standard, .list-item, .section-header, .text-secondary, .fade-in, etc.)
//
// PRINCIPLES — Design the entire app with mobile first:
// 1. MOBILE FIRST — Default styles are for phones. Use @include tablet { } and @include desktop { }
//    to enhance for larger screens. Test on narrow viewports first. No separate "desktop" design.
// 2. ONE SPACING SCALE — 4px base ($space-1..$space-16). No arbitrary values in components.
// 3. TOUCH TARGETS ≥ 44px on mobile — $touch-min (2.75rem); use touch-target mixin for tap areas.
// 4. Colors from daisyUI theme only (--b1, --bc, --p, etc.); no hardcoded hex in patterns.
//
// Usage in component SCSS: @use 'path/to/styles/design-system' as ds; then ds.$space-4, @include ds.tablet, etc.
// Pattern classes are global; use them in templates (e.g. class="card-standard list-item").
//
// ============================================
// 1. BREAKPOINTS (Mobile First)
// ============================================
$mobile: 0; // Phones (default)
$tablet: 640px; // sm: Tablets & large phones
$desktop: 1024px; // lg: Desktops & laptops
$wide: 1280px; // xl: Large desktops

// ============================================
// 2. SPACING SCALE (4px base unit)
// ============================================
// Use: padding, margin, gap
// Mobile: Tighter spacing to conserve screen
// Desktop: More generous spacing for breathing room

$space-0: 0;
$space-1: 0.25rem; // 4px  - Tiny gaps
$space-2: 0.5rem; // 8px  - Small gaps, icon spacing
$space-3: 0.75rem; // 12px - Card padding (mobile)
$space-4: 1rem; // 16px - Default spacing
$space-5: 1.25rem; // 20px - Medium spacing
$space-6: 1.5rem; // 24px - Section spacing (mobile)
$space-8: 2rem; // 32px - Large spacing
$space-10: 2.5rem; // 40px - Extra large
$space-12: 3rem; // 48px - Section spacing (desktop)
$space-16: 4rem; // 64px - Hero spacing

// ============================================
// 3. TYPOGRAPHY SCALE
// ============================================
// Mobile-first sizing with desktop enhancements

// Font Families (single source of truth for app typography)
$font-family-sans:
  'Outfit',
  system-ui,
  -apple-system,
  BlinkMacSystemFont,
  'Segoe UI',
  sans-serif;
$font-family-mono: ui-monospace, 'Cascadia Code', 'Consolas', monospace;

// Font Sizes
$text-xs: 0.625rem; // 10px - Tiny labels, timestamps
$text-sm: 0.75rem; // 12px - Secondary text, captions
$text-base: 0.875rem; // 14px - Body text (mobile)
$text-lg: 1rem; // 16px - Body text (desktop), headings (mobile)
$text-xl: 1.125rem; // 18px - Subheadings
$text-2xl: 1.25rem; // 20px - Section headings (mobile)
$text-3xl: 1.5rem; // 24px - Section headings (desktop)
$text-4xl: 1.875rem; // 30px - Page titles (mobile)
$text-5xl: 2.25rem; // 36px - Page titles (desktop)
$text-6xl: 3rem; // 48px - Hero text

// Font Weights
$font-normal: 400;
$font-medium: 500;
$font-semibold: 600;
$font-bold: 700;

// Line Heights
$leading-tight: 1.2; // Headings
$leading-snug: 1.375; // Compact text
$leading-normal: 1.5; // Body text
$leading-relaxed: 1.625; // Spacious text

// Letter Spacing
$tracking-tight: -0.025em; // Headlines
$tracking-normal: 0; // Body
$tracking-wide: 0.025em; // Buttons, labels
$tracking-wider: 0.05em; // Uppercase labels

// ============================================
// 4. TOUCH TARGETS
// ============================================
// Minimum touch target sizes for mobile

$touch-min: 2.75rem; // 44px - iOS/Android minimum
$touch-comfortable: 3rem; // 48px - Comfortable
$touch-generous: 3.5rem; // 56px - Generous

// ============================================
// 5. BORDER RADIUS
// ============================================
$radius-sm: 0.375rem; // 6px  - Small elements
$radius-md: 0.5rem; // 8px  - Cards, buttons
$radius-lg: 0.75rem; // 12px - Large cards
$radius-xl: 1rem; // 16px - Modals, drawers
$radius-full: 9999px; // Pills, circles

// ============================================
// 6. SHADOWS (Elevation)
// ============================================
// Subtle depth without overwhelming mobile screens

$shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
$shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
$shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
$shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);

// ============================================
// 7. TRANSITIONS
// ============================================
// Smooth, not distracting

$transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
$transition-base: 200ms cubic-bezier(0.4, 0, 0.2, 1);
$transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);

// Duration-only tokens (for animation shorthand where easing is specified separately)
$duration-fast: 150ms;
$duration-base: 200ms;
$duration-slow: 300ms;

$ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
$ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);

// ============================================
// 8. Z-INDEX SCALE
// ============================================
$z-base: 0;
$z-dropdown: 10;
$z-sticky: 20;
$z-overlay: 30;
$z-modal: 40;
$z-toast: 50;

// ============================================
// 9. CONTAINER WIDTHS
// ============================================
$container-sm: 640px; // Narrow content
$container-md: 768px; // Standard content
$container-lg: 1024px; // Wide content
$container-xl: 1280px; // Dashboard max
$container-2xl: 1536px; // Full width limit

// ============================================
// UTILITY MIXINS
// ============================================

// Mobile-first responsive mixin
@mixin tablet {
  @media (min-width: $tablet) {
    @content;
  }
}

@mixin desktop {
  @media (min-width: $desktop) {
    @content;
  }
}

@mixin wide {
  @media (min-width: $wide) {
    @content;
  }
}

// Touch device detection
@mixin touch-device {
  @media (hover: none) and (pointer: coarse) {
    @content;
  }
}

// Focus states
@mixin focus-ring {
  outline: 2px solid oklch(var(--p));
  outline-offset: 2px;
}

// Card pattern
@mixin card {
  background: oklch(var(--b1));
  border-radius: $radius-lg;
  border: 2px solid oklch(var(--b3));
  transition: all $transition-base;
}

// Touch target
@mixin touch-target {
  min-height: $touch-min;
  min-width: $touch-min;

  @include tablet {
    min-height: auto;
    min-width: auto;
  }
}

// Smooth text
@mixin text-smooth {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

// Tabular numbers (for aligning numbers)
@mixin tabular-nums {
  font-variant-numeric: tabular-nums;
  font-feature-settings: 'tnum';
}

// Truncate text
@mixin truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// Line clamp
@mixin line-clamp($lines: 2) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

// ============================================
// INTERACTION MIXINS
// ============================================
// Composable tactile feedback for interactive elements.
// Use these in any component or global stylesheet.
// All honor reduced-motion via the global rule in styles.scss.

/// Radial ink-wash on :active via ::after pseudo-element.
/// Does not block pointer-events. Requires no extra DOM.
/// The fade-out is intentionally slow ($duration-slow) so the flash is
/// perceptible even when :active is very brief (mobile tap).
@mixin ripple {
  position: relative;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;

  &::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 50%, oklch(var(--bc) / 0.15) 0%, transparent 70%);
    opacity: 0;
    // Slow fade-out keeps the wash visible after a quick tap
    transition: opacity $duration-slow $ease-in-out;
    pointer-events: none;
    border-radius: inherit;
  }

  &:active::after {
    opacity: 1;
    // Instant flash on press
    transition-duration: 0ms;
  }

  @media (hover: hover) {
    &:hover::after {
      opacity: 0.6;
    }
  }
}

/// Subtle scale-down on :active for tappable containers.
@mixin press {
  transition: transform $duration-fast $ease-in-out;

  &:active {
    transform: scale(0.97);
  }
}

/// Background tint on :active for rows/list items.
@mixin row-highlight {
  transition: background-color $duration-fast $ease-in-out;
  -webkit-tap-highlight-color: transparent;

  &:active {
    background-color: oklch(var(--bc) / 0.06);
  }

  @media (hover: hover) {
    &:hover {
      background-color: oklch(var(--bc) / 0.03);
    }
  }
}

// ============================================
// PATTERN CLASSES (use in templates; all use tokens/mixins above)
// ============================================

.card-standard {
  @include card;
  padding: $space-4;
  @include tablet {
    padding: $space-6;
  }
}

.stat-card {
  @include card;
  @include press;
  padding: $space-3;
  cursor: pointer;
  transition: all $transition-base;
  @include tablet {
    padding: $space-4;
  }
  @include touch-device {
    @include touch-target;
  }
}

.stat-card-overview {
  @extend .stat-card;
  background: oklch(var(--b1));
  border-color: oklch(var(--b3));

  &:hover {
    border-color: oklch(var(--bc) / 0.15);
  }
}

.stat-card-sales {
  @extend .stat-card;
  background: oklch(var(--su) / 0.04);
  border-left-color: oklch(var(--su));

  &:hover {
    background: oklch(var(--su) / 0.07);
  }
}

.stat-card-purchases {
  @extend .stat-card;
  background: oklch(var(--in) / 0.04);
  border-left-color: oklch(var(--in));

  &:hover {
    background: oklch(var(--in) / 0.07);
  }
}

.stat-card-expenses {
  @extend .stat-card;
  background: oklch(var(--er) / 0.04);
  border-left-color: oklch(var(--er));

  &:hover {
    background: oklch(var(--er) / 0.07);
  }
}

.section-collapse {
  @include card;
  overflow: hidden;
  .collapse-header {
    @include touch-target;
    @include ripple;
    & {
      padding: $space-3 $space-4;
      display: flex;
      align-items: center;
      gap: $space-3;
      cursor: pointer;
    }
    @include tablet {
      padding: $space-4;
    }
  }
  .collapse-content {
    & {
      padding: $space-3 $space-4 $space-4;
    }
    @include tablet {
      padding: $space-4;
    }
  }
}

.action-button {
  @include touch-target;
  @include press;
  & {
    font-weight: $font-semibold;
    font-size: $text-base;
    letter-spacing: $tracking-wide;
    transition: all $transition-base;
  }
  @include tablet {
    font-size: $text-lg;
  }
  &:focus-visible {
    @include focus-ring;
  }
}

.list-item {
  @include touch-target;
  @include row-highlight;
  & {
    padding: $space-3 $space-4;
    display: flex;
    align-items: center;
    gap: $space-3;
  }
  @include tablet {
    padding: $space-4;
    min-height: auto;
  }
}

.form-field {
  @include touch-target;
  & {
    padding: $space-3 $space-4;
    border-radius: $radius-md;
    font-size: $text-base;
    transition: all $transition-fast;
  }
  &:focus {
    @include focus-ring;
  }
  @include tablet {
    padding: $space-3 $space-4;
  }
}

.section-header {
  margin-bottom: $space-4;
  @include tablet {
    margin-bottom: $space-6;
  }
  h2 {
    font-size: $text-2xl;
    font-weight: $font-bold;
    letter-spacing: $tracking-tight;
    line-height: $leading-tight;
    margin-bottom: $space-2;
    @include tablet {
      font-size: $text-3xl;
    }
    @include desktop {
      font-size: $text-4xl;
    }
  }
  p {
    font-size: $text-sm;
    opacity: 0.7;
    @include tablet {
      font-size: $text-base;
    }
  }
}

.grid-responsive {
  display: grid;
  gap: $space-2;
  @include tablet {
    gap: $space-4;
  }
  @include desktop {
    gap: $space-6;
  }
}

.grid-1-col {
  grid-template-columns: 1fr;
}

.grid-2-col {
  grid-template-columns: repeat(2, 1fr);
  @include tablet {
    grid-template-columns: repeat(2, 1fr);
  }
}

.grid-3-col {
  grid-template-columns: repeat(3, 1fr);
  @include tablet {
    grid-template-columns: repeat(3, 1fr);
  }
}

.grid-auto-fit {
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
}

.progress-bar {
  height: $space-1;
  background: oklch(var(--b3));
  border-radius: $radius-full;
  overflow: hidden;
  .progress-fill {
    height: 100%;
    border-radius: $radius-full;
    transition: width $transition-slow;
  }
}

.status-dot {
  width: $space-2;
  height: $space-2;
  border-radius: $radius-full;
}

.text-secondary {
  color: oklch(var(--bc) / 0.7);
}

.text-tertiary {
  color: oklch(var(--bc) / 0.5);
}

.badge-custom {
  display: inline-flex;
  align-items: center;
  gap: $space-1;
  padding: $space-1 $space-2;
  font-size: $text-xs;
  font-weight: $font-semibold;
  letter-spacing: $tracking-wide;
  text-transform: uppercase;
  border-radius: $radius-full;
}

// ============================================
// TABLE — ROW-CLICK PATTERN
// ============================================
// RULE: All tables MUST define a primary action on row click.
// Rows navigate to a detail view; explicit "View" buttons are forbidden.
// Contextual actions (Pay, Print, Delete) remain as icon buttons
// in the last column and MUST call $event.stopPropagation().
//
// Desktop: `<tr>` host gets cursor-pointer + row-highlight.
// Mobile:  Card variant navigates on tap; contextual actions
//          in a footer strip.

.table-clickable {
  tbody tr {
    cursor: pointer;
    @include row-highlight;
  }
}

// ============================================
// KPI CARD PATTERN
// ============================================
// Tinted card with a semantic top-accent bar (::before).
// Use for always-visible performance metrics at the top of a page.
// Structure: icon + label header, then large bold number, optional
// sparkline or sub-stat.

@mixin kpi-card($color-var) {
  @include card;
  position: relative;
  overflow: hidden;
  padding: $space-3;
  background: oklch(var(#{$color-var}) / 0.04);

  @include tablet {
    padding: $space-4;
  }

  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: oklch(var(#{$color-var}));
  }
}
