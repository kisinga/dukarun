<div class="card bg-base-100 shadow-lg">
  <div class="card-body p-4 sm:p-6 space-y-4">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2">
      <div>
        <h2 class="text-lg sm:text-xl font-bold">General Settings</h2>
        <p class="text-sm opacity-60">Configure your company preferences</p>
      </div>
      <button
        class="btn btn-primary btn-sm w-full sm:w-auto"
        [disabled]="!hasChanges() || settingsService.loading()"
        (click)="saveSettings()"
      >
        @if (settingsService.loading()) {
          <span class="loading loading-spinner loading-xs"></span>
        }
        Save Changes
      </button>
    </div>

    <!-- Error Alert -->
    @if (settingsService.error(); as error) {
      <div class="alert alert-error py-2 text-sm">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z"
            clip-rule="evenodd"
          />
        </svg>
        <span>{{ error }}</span>
      </div>
    }

    <!-- Company Logo -->
    <div class="bg-base-200 rounded-lg p-4">
      <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
        <!-- Logo Display -->
        @if (selectedLogoFile(); as selectedFile) {
          <div class="avatar">
            <div class="w-20 rounded-lg">
              <img [src]="logoPreview()" alt="New Logo Preview" />
            </div>
          </div>
          <div class="flex-1">
            <div class="text-sm font-medium text-primary">New logo selected</div>
            <div class="text-xs opacity-60">{{ selectedFile.name }}</div>
            <button class="btn btn-xs btn-ghost text-error mt-2" (click)="removeSelectedLogo()">
              Remove
            </button>
          </div>
        } @else if (companyLogoAsset(); as logoAsset) {
          <div class="avatar">
            <div class="w-20 rounded-lg">
              <img [src]="logoAsset.preview || logoAsset.source" alt="Company Logo" />
            </div>
          </div>
          <div class="flex-1">
            <div class="text-sm font-medium">Company Logo</div>
            <div class="flex gap-2 mt-2">
              <button class="btn btn-xs btn-outline" (click)="selectLogoFile()">Change</button>
              <button class="btn btn-xs btn-ghost text-error" (click)="removeExistingLogo()">
                Remove
              </button>
            </div>
          </div>
        } @else {
          <div class="w-20 h-20 bg-base-300 rounded-lg flex items-center justify-center">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-8 w-8 opacity-40"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
              />
            </svg>
          </div>
          <div class="flex-1">
            <div class="text-sm opacity-60">No logo set</div>
            <button class="btn btn-xs btn-primary mt-2" (click)="selectLogoFile()">Add Logo</button>
          </div>
        }
      </div>
    </div>

    <!-- Toggle Settings -->
    <div class="space-y-2">
      <!-- Cashier Flow -->
      <label class="flex items-center justify-between bg-base-200 rounded-lg p-3 cursor-pointer">
        <div class="flex-1 min-w-0 pr-4">
          <div class="text-sm font-medium">Cashier Approval Flow</div>
          <div class="text-xs opacity-60">Orders require cashier approval</div>
        </div>
        <input
          type="checkbox"
          class="toggle toggle-primary toggle-sm"
          [checked]="settings()?.cashierFlowEnabled"
          (change)="toggleCashierFlow($event)"
        />
      </label>

      <!-- Printer -->
      <label class="flex items-center justify-between bg-base-200 rounded-lg p-3 cursor-pointer">
        <div class="flex-1 min-w-0 pr-4">
          <div class="text-sm font-medium">Enable Printer</div>
          <div class="text-xs opacity-60">Show print button at checkout</div>
        </div>
        <input
          type="checkbox"
          class="toggle toggle-primary toggle-sm"
          [checked]="settings()?.enablePrinter"
          (change)="togglePrinter($event)"
        />
      </label>
    </div>
  </div>
</div>
