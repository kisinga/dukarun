<app-page-header title="Channels" class="mb-6" />
@if (loading()) {
  <div class="flex items-center gap-2 text-base-content/70">
    <span class="loading loading-spinner loading-md"></span>
    <span>Loading…</span>
  </div>
}
@if (error()) {
  <div role="alert" class="alert alert-error">
    <span>{{ error() }}</span>
  </div>
}
@if (channels().length) {
  <div class="overflow-x-auto rounded-xl border border-base-300 bg-base-100 shadow">
    <table class="table">
      <thead>
        <tr>
          <th>Code</th>
          <th>Status</th>
          <th>Trial ends</th>
          <th>Subscription</th>
          <th>SMS (used / limit)</th>
          <th>Max admins</th>
          <th>Cashier</th>
          <th>Printer</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        @for (ch of channels(); track ch.id) {
          <tr>
            <td class="font-medium">{{ ch.code }}</td>
            <td>
              <span class="badge badge-sm" [class.badge-success]="ch.customFields.status === 'APPROVED'" [class.badge-warning]="ch.customFields.status === 'UNAPPROVED'" [class.badge-error]="ch.customFields.status === 'DISABLED' || ch.customFields.status === 'BANNED'" [class.badge-ghost]="ch.customFields.status !== 'APPROVED' && ch.customFields.status !== 'UNAPPROVED' && ch.customFields.status !== 'DISABLED' && ch.customFields.status !== 'BANNED'">
                {{ ch.customFields.status }}
              </span>
            </td>
            <td>{{ formatDate(ch.customFields.trialEndsAt) }}</td>
            <td>{{ ch.customFields.subscriptionStatus }}</td>
            <td>{{ ch.customFields.smsUsedThisPeriod ?? 0 }} / {{ ch.customFields.smsLimitFromTier ?? '—' }}</td>
            <td>{{ ch.customFields.maxAdminCount }}</td>
            <td>{{ ch.customFields.cashierFlowEnabled ? 'Yes' : 'No' }}</td>
            <td>{{ ch.customFields.enablePrinter ? 'Yes' : 'No' }}</td>
            <td>
              <a [routerLink]="['/channels', ch.id]" class="btn btn-ghost btn-sm">View</a>
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
} @else if (!loading()) {
  <p class="text-base-content/70">No channels.</p>
}
